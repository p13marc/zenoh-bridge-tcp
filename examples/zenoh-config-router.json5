// Zenoh Router configuration file for zenoh-bridge-tcp
// This configuration sets up the bridge as a Zenoh router
// Usage: zenoh-bridge-tcp --config examples/zenoh-config-router.json5 --export 'myservice/127.0.0.1:8003'

{
  // Router mode - acts as a message broker between peers and clients
  mode: "router",

  metadata: {
    name: "tcp-bridge-router",
    role: "bridge",
  },

  // Connect to other routers in the network (optional)
  connect: {
    endpoints: [
      // Uncomment to connect to other routers
      // "tcp/router1.example.com:7447",
      // "tcp/router2.example.com:7447",
    ],
  },

  // Listen on standard Zenoh router port
  listen: {
    endpoints: [
      // Listen on all interfaces, port 7447 (standard Zenoh router port)
      "tcp/[::]:7447",
    ],
  },

  // Scouting configuration
  scouting: {
    multicast: {
      enabled: true,
      address: "224.0.0.224:7446",
      interface: "auto",
      // Routers typically don't auto-connect via multicast
      autoconnect: {
        router: [],
        peer: [],
        client: [],
      },
      // Listen for scout messages from peers and clients
      listen: true,
    },
  },

  // Router-specific routing configuration
  routing: {
    router: {
      // Enable failover brokering between peers
      peers_failover_brokering: true,
    },
  },

  // Transport configuration optimized for router role
  transport: {
    unicast: {
      // Maximum number of simultaneous sessions
      max_sessions: 1000,
      // Maximum links per transport
      max_links: 4,
      qos: {
        enabled: true,
      },
    },
    link: {
      tx: {
        batch_size: 65535,
        lease: 10000,
        // Keep-alive messages per lease period
        keep_alive: 4,
      },
      rx: {
        // Receiving buffer size
        buffer_size: 65535,
      },
    },
  },

  // Enable timestamping in router mode
  timestamping: {
    enabled: {
      router: true,
      peer: false,
      client: false,
    },
  },

  queries_default_timeout: 10000,
}
